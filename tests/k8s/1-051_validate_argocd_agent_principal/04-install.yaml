apiVersion: argoproj.io/v1beta1
kind: ArgoCD
metadata:
  name: argocd
  namespace: argocd-e2e-cluster-config
spec:
  controller:
    enabled: false
  argoCDAgent:
    principal:
      enabled: true
      server:
        auth: "mtls:CN=([^,]+)"
        logLevel: "info"
        env:
          - name: TEST_ENV
            value: test_value
      namespace:
        allowedNamespaces:
          - "*"
      tls:
        insecureGenerate: true
      jwt:
        insecureGenerate: true
  sourceNamespaces:
    - "agent-managed"
    - "agent-autonomous"