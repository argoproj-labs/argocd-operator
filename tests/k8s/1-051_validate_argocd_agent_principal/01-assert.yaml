apiVersion: kuttl.dev/v1beta1
kind: TestAssert
timeout: 120
---
apiVersion: argoproj.io/v1beta1
kind: ArgoCD
metadata:
  name: argocd
  namespace: argocd-e2e-cluster-config
status:
  phase: Available
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: argocd-agent-principal
  namespace: argocd-e2e-cluster-config
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: argocd-agent-principal
  namespace: argocd-e2e-cluster-config
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: argocd-agent-principal
  namespace: argocd-e2e-cluster-config 
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
 name: argocd-argocd-e2e-cluster-config-agent-principal  
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: argocd-argocd-e2e-cluster-config-agent-principal
---
apiVersion: v1
kind: Service
metadata:
  name: argocd-agent-principal
  namespace: argocd-e2e-cluster-config
spec:
  type: LoadBalancer
---
apiVersion: v1
kind: Service
metadata:
  name: argocd-agent-principal-metrics
  namespace: argocd-e2e-cluster-config
spec:
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: argocd-redis
  namespace: argocd-e2e-cluster-config
spec:
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: argocd-repo-server
  namespace: argocd-e2e-cluster-config
spec:
  type: LoadBalancer  
---
apiVersion: v1
kind: Service
metadata:
  name: argocd-server
  namespace: argocd-e2e-cluster-config
spec:
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: argocd-agent-principal-redisproxy
  namespace: argocd-e2e-cluster-config  
spec:
  ports:
  - name: redis
    port: 6379
    protocol: TCP
    targetPort: 6379
  selector:
    app.kubernetes.io/name: argocd-agent-principal
  sessionAffinity: None
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: argocd-redis
  namespace: argocd-e2e-cluster-config
status:
  readyReplicas: 1  
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: argocd-repo-server
  namespace: argocd-e2e-cluster-config
status:
  readyReplicas: 1
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: argocd-server
  namespace: argocd-e2e-cluster-config
status:
  readyReplicas: 1
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: argocd-agent-principal
  namespace: argocd-e2e-cluster-config
  labels:
    app.kubernetes.io/component: principal
    app.kubernetes.io/managed-by: argocd
    app.kubernetes.io/name: argocd-agent-principal
    app.kubernetes.io/part-of: argocd-agent
